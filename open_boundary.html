

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Open Boundary Problems &mdash; magnum.fe 2.2.2 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="magnum.fe 2.2.2 documentation" href="index.html"/>
        <link rel="next" title="Miscellaneous" href="misc.html"/>
        <link rel="prev" title="Solvers" href="solvers.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> magnum.fe
          

          
          </a>

          
            
            
              <div class="version">
                2.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="meshing.html">Meshes and domains</a></li>
<li class="toctree-l1"><a class="reference internal" href="oscillator.html">A Simple Spin-Torque Oscillator</a></li>
<li class="toctree-l1"><a class="reference internal" href="state.html">State and Materials</a></li>
<li class="toctree-l1"><a class="reference internal" href="llg.html">Integrators for the Landau-Lifshitz-Gilbert Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="loggers.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="field_terms.html">Field Terms</a></li>
<li class="toctree-l1"><a class="reference internal" href="spin_diffusion.html">Spin diffusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="solvers.html">Solvers</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Open Boundary Problems</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#shell-transformation-method">Shell-Transformation Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hybrid-fem-bem-method-fredkin-and-koehler">Hybrid FEM-BEM Method (Fredkin and Koehler)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#direct-fem-bem-method-johnson-and-nedelec">Direct FEM-BEM Method (Johnson and Nedelec)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="misc.html">Miscellaneous</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">magnum.fe</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Open Boundary Problems</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/open_boundary.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <span class="target" id="module-magnumfe"></span><div class="section" id="open-boundary-problems">
<span id="open-boundary"></span><h1>Open Boundary Problems<a class="headerlink" href="#open-boundary-problems" title="Permalink to this headline">¶</a></h1>
<p>Multiple effective-field terms, namely the demagnetization field (<a class="reference internal" href="field_terms.html#magnumfe.DemagField" title="magnumfe.DemagField"><code class="xref py py-class docutils literal"><span class="pre">DemagField</span></code></a>) and the Oersted field (<a class="reference internal" href="field_terms.html#magnumfe.OerstedField" title="magnumfe.OerstedField"><code class="xref py py-class docutils literal"><span class="pre">OerstedField</span></code></a>) involve the solution of so called open-boundary problems of the form</p>
<div class="math">
\[\begin{split}\Delta u                                         &amp;= \nabla \cdot \vec{f}     \quad \text{in} \quad \omega \\
\Delta u                                         &amp;= 0                        \quad \text{in} \quad \mathbb{R}^3 \setminus \omega \\
[u]                                              &amp;= 0                        \quad \text{on} \quad \partial\omega \\
\left[\frac{\partial u}{\partial \vec{n}}\right] &amp;= - \vec{f} \cdot \vec{n}  \quad \text{on} \quad \partial\omega \\
u(\vec{x})                                       &amp;= \mathcal{O}(1/|\vec{x}|) \quad \text{if} \quad |\vec{x}| \rightarrow \infty\end{split}\]</div>
<p>different algorithms are available for the solution of these problems.</p>
<div class="section" id="shell-transformation-method">
<span id="shell-transformation"></span><h2>Shell-Transformation Method<a class="headerlink" href="#shell-transformation-method" title="Permalink to this headline">¶</a></h2>
<p>The shell-transformation method for the solution of open-boundary problems with the finite-element method was introduced in <a class="reference internal" href="#brunotte1992" id="id1">[Brunotte1992]</a>.
The region of interest <span class="math">\(\omega_\text{notrans}\)</span> is surrounded by a finite shell <span class="math">\(\omega_\text{trans}\)</span>.
A bijective transformation is constructed that maps the shell region <span class="math">\(\omega_\text{trans}\)</span> onto the complete exterior region <span class="math">\(\mathbb{R}^3 \setminus \omega_\text{notrans}\)</span>.
The open-boundary conditions can thus be implemented by requiring homogeneous Dirichlet boundary condition of the outer boundary of the shell <span class="math">\(\omega_\text{trans}\)</span>, resulting in the following weak formulation</p>
<div class="math">
\[\int_{\omega_\text{notrans}} \nabla u \cdot \nabla v \dx + \int_{\omega_\text{trans}} (\nabla u)^T \mat{g} \nabla v \dx = \int_{\omega} \vec{f} \cdot \nabla v \dx\]</div>
<p>with the metric tensor <span class="math">\(\mat{g}\)</span> defined as</p>
<div class="math">
\[\mat{g} = (\mat{J}^{-1})^T | \det \mat{J} | \mat{J}^{-1}\]</div>
<p>where <span class="math">\(\mat{J}\)</span> denotes the Jacobian of the transformation.
The untransformed region <span class="math">\(\omega_\text{notrans}\)</span> does not have to coincide with the sample region <span class="math">\(\omega\)</span> of the original problem, but it holds <span class="math">\(\omega \subseteq \omega_\text{notrans}\)</span>.</p>
<p>magnum.fe uses cuboid shells, i.e. <span class="math">\(\omega_\text{notrans}\)</span> has to be of cuboidal shape. The applied method is described in detail in <a class="reference internal" href="#abert2013a" id="id2">[Abert2013a]</a>.</p>
</div>
<div class="section" id="hybrid-fem-bem-method-fredkin-and-koehler">
<span id="fem-bem"></span><h2>Hybrid FEM-BEM Method (Fredkin and Koehler)<a class="headerlink" href="#hybrid-fem-bem-method-fredkin-and-koehler" title="Permalink to this headline">¶</a></h2>
<p>A hybrid FEM-BEM approach for the solution of open-boundary problems was proposed by Fredkin and Koehler <a class="reference internal" href="#fredkin1990" id="id3">[Fredkin1990]</a>. Consider the following splitting of the solution <span class="math">\(u\)</span>:</p>
<div class="math">
\[u = u_1 + u_2\]</div>
<p><span class="math">\(u_1\)</span> is defined by</p>
<div class="math">
\[\begin{split}\Delta u_1                            &amp;= \nabla \cdot \vec{f}    \quad \text{in} \quad \omega \\
\frac{\partial u_1}{\partial \vec{n}} &amp;= - \vec{f} \cdot \vec{n} \quad \text{on} \quad \partial\omega \\
u_1                                   &amp;= 0                       \quad \text{in} \quad \mathbb{R}^3 \setminus \omega.\end{split}\]</div>
<p>This Neuman problem within <span class="math">\(\omega\)</span> is solved with the finite-element method.
While <span class="math">\(u_1\)</span> solves for the right-hand side <span class="math">\(\nabla \cdot \vec{f}\)</span> and fullfills the jump condition of the normal derivative <span class="math">\(- \vec{f} \cdot \vec{n}\)</span> it is not continuous across <span class="math">\(\partial \omega\)</span>.
This jump is compensated by <span class="math">\(u_2\)</span> which is defined as</p>
<div class="math">
\[\begin{split}\Delta u_2                                         &amp;= 0                        \quad \text{in} \quad \omega \\
[u_2]                                              &amp;= - [u_1]                  \quad \text{on} \quad \partial \omega \\
\left[\frac{\partial u_2}{\partial \vec{n}}\right] &amp;= 0                        \quad \text{on} \quad \partial\omega \\
u_2(\vec{x})                                       &amp;= \mathcal{O}(1/|\vec{x}|) \quad \text{if} \quad |\vec{x}| \rightarrow \infty\end{split}\]</div>
<p>This system is solved by the double-layer potential</p>
<div class="math">
\[u_2 = \int_{\partial \omega} u_1 \frac{\partial}{\partial \vec{n}} \frac{1}{|\vec{x} - \vec{x}'|} \dx\]</div>
<p>The double-layer potential is computed on the boundary <span class="math">\(\partial \omega\)</span> with the boundary-element method. This can be done either by numeric integration of a Galerkin-BEM approach (<code class="docutils literal"><span class="pre">bem_method</span> <span class="pre">=</span> <span class="pre">&quot;BEM++&quot;</span></code>) or by analytic integration of the Collocation-BEM operators (<code class="docutils literal"><span class="pre">bem_method</span> <span class="pre">=</span> <span class="pre">&quot;H2LIB&quot;</span></code>) <a class="reference internal" href="#lindholm1984" id="id4">[Lindholm1984]</a>. The collocation method uses <span class="math">\(H^2\)</span>-matrices provided by H2Lib, whereas the Galerkin method uses <span class="math">\(H\)</span>-matrices provided by BEM++.</p>
<p>These values are used as Dirichlet boundary conditions to solve <span class="math">\(u_2\)</span> within <span class="math">\(\omega\)</span> with the finite-element method.
For a detailed description of the method, see <a class="reference internal" href="#fredkin1990" id="id5">[Fredkin1990]</a>.</p>
</div>
<div class="section" id="direct-fem-bem-method-johnson-and-nedelec">
<h2>Direct FEM-BEM Method (Johnson and Nedelec)<a class="headerlink" href="#direct-fem-bem-method-johnson-and-nedelec" title="Permalink to this headline">¶</a></h2>
<p>The solution of (magnetostatic) Maxwell equations requires to handle more complicated jump conditions than the ones assumed for the methods above.</p>
<p>A general open-boundary problem with arbitrary jump-conditions may be solved by the method proposed by Johnson and Nedelec <a class="reference internal" href="#johnson1980" id="id6">[Johnson1980]</a>. Compared with the methods presented above it is able to handle arbitrary (scaled) boundary jump conditions for the potential <span class="math">\(u\)</span> as well as for the normal derivative <span class="math">\(\phi = \frac{\partial u}{\partial \vec{n}}\)</span> The current implementation assumes non-scaled boundary jump conditions for the potential <span class="math">\(u\)</span>) whereas the jump of the normal derivative may be scaled by a function <span class="math">\(\mu\)</span>:</p>
<div class="math">
\[\begin{split}L u                         &amp;= f                        \quad \text{in} \quad \omega \\
L u                         &amp;= 0                        \quad \text{in} \quad \mathbb{R}^3 \setminus \omega \\
[u]                         &amp;= u_0                      \quad \text{on} \quad \partial\omega \\
\left[\mu \, \phi \right]   &amp;= \phi_0                   \quad \text{on} \quad \partial\omega \\
u(\vec{x})                  &amp;= \mathcal{O}(1/|\vec{x}|) \quad \text{if} \quad |\vec{x}| \rightarrow \infty\end{split}\]</div>
<p>The problem is solved by combining FEM and BEM equations and solve them simultaneously by means of an iterative method like GMRES. The BEM part is based on the external representation formula derived from Green&#8217;s second identity, whereas the FEM part directly follows from a Galerkin FEM approach, where the Neumann boundary condition are left as unknowns. The combined Galerkin formulation of the upper problem results in the following system of equations</p>
<div class="math">
\[\begin{split}a(u, v) - \left\langle \phi, v \right\rangle_\Gamma &amp;= \left\langle f, v\right\rangle_\Omega + \left\langle\phi_0, v\right\rangle_\Gamma \\
\left\langle \left(\frac{1}{2} - K \right) u, \psi \right\rangle_\Gamma + \left\langle V \, \phi, \psi \right\rangle_\Gamma &amp;= \left\langle \left(\frac{1}{2} - K \right) u_0, \psi \right\rangle_\Gamma\end{split}\]</div>
<p>with the weak form <span class="math">\(a(u,v)\)</span> of the differential operator <span class="math">\(L\)</span>, the unknown potential <span class="math">\(u\)</span> and (outer) normal derivative <span class="math">\(\phi\)</span>. The scalar product <span class="math">\(\langle u , v \rangle_D\)</span> stands for the integral of the function <span class="math">\(u\)</span> weighted by the test function <span class="math">\(v\)</span> over a domain <span class="math">\(D\)</span>. The occuring single-layer operator <span class="math">\(V\)</span> as well as the double-layer operator <span class="math">\(K\)</span> are defined as</p>
<div class="math">
\[\begin{split}V \phi(x) &amp;= \int_\Gamma G(x,x') \, \phi(x') \, d\Gamma(x') \\
K u(x)    &amp;= \int_\Gamma \partial_{n(x')} G(x,x') \, u(x') \, d\Gamma(x')\end{split}\]</div>
<p>References:</p>
<table class="docutils citation" frame="void" id="brunotte1992" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[Brunotte1992]</a></td><td>Brunotte, X., Meunier, G., &amp; Imhoff, J. F. (1992). Finite element modeling of unbounded problems using transformations: a rigorous, powerful and easy solution. IEEE Transactions on Magnetics, 28(2), 1663-1666.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="abert2013a" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[Abert2013a]</a></td><td>Abert, C., Exl, L., Selke, G., Drews, A., &amp; Schrefl, T. (2013). Numerical methods for the stray-field calculation: A comparison of recently developed algorithms. Journal of Magnetism and Magnetic Materials, 326, 176-185.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="fredkin1990" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Fredkin1990]</td><td><em>(<a class="fn-backref" href="#id3">1</a>, <a class="fn-backref" href="#id5">2</a>)</em> Fredkin, D. R., &amp; Koehler, T. R. (1990). Hybrid method for computing demagnetizing fields. IEEE Transactions on Magnetics, 26(2), 415-417.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="lindholm1984" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[Lindholm1984]</a></td><td>Lindholm, D. A. (1984). Three-Dimensional Magnetostatic Fields from Point-Matched Integral Equations with Linearly Varying Scalar Sources. IEEE Transactions on Magnetics, 20(5), 2025-2032.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="johnson1980" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[Johnson1980]</a></td><td>Johnson, C., &amp; Nedelec, J. C. (1980). On the Coupling of Boundary Integral and Finite Element Methods, Mathematics of Computation, 35(152).</td></tr>
</tbody>
</table>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="misc.html" class="btn btn-neutral float-right" title="Miscellaneous" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="solvers.html" class="btn btn-neutral" title="Solvers" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, SuessCo.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.2.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/MathJax_local.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>